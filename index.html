<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®šæ—¶ä»»åŠ¡ç®¡ç†</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
      font-size: 14px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* æ ‡é¢˜æ  */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .header h1 {
      font-size: 24px;
      color: #333;
    }

    .header-actions {
      display: flex;
      gap: 10px;
    }

    /* æŒ‰é’®æ ·å¼ */
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #1890ff;
      color: white;
    }

    .btn-primary:hover {
      background: #40a9ff;
    }

    .btn-danger {
      background: #ff4d4f;
      color: white;
    }

    .btn-danger:hover {
      background: #ff7875;
    }

    .btn-default {
      background: #fff;
      border: 1px solid #d9d9d9;
      color: #333;
    }

    .btn-default:hover {
      border-color: #40a9ff;
      color: #40a9ff;
    }

    .btn-sm {
      padding: 4px 8px;
      font-size: 12px;
    }

    /* å¡ç‰‡ */
    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin-bottom: 20px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #f0f0f0;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      color: #333;
    }

    /* è¡¨å•æ ·å¼ */
    .form-group {
      margin-bottom: 16px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 500;
    }

    .form-input,
    .form-select,
    .form-textarea {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      font-size: 14px;
      transition: all 0.2s;
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
      outline: none;
      border-color: #40a9ff;
      box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    }

    .form-textarea {
      resize: vertical;
      min-height: 100px;
      font-family: 'Consolas', 'Monaco', monospace;
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    /* ä»»åŠ¡åˆ—è¡¨ */
    .task-list {
      list-style: none;
    }

    .task-item {
      background: #fafafa;
      border: 1px solid #f0f0f0;
      border-radius: 4px;
      padding: 12px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .task-item.disabled {
      opacity: 0.6;
    }

    .task-status {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .task-status.enabled {
      background: #52c41a;
    }

    .task-status.disabled {
      background: #d9d9d9;
    }

    .task-info {
      flex: 1;
      min-width: 0;
    }

    .task-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 4px;
    }

    .task-detail {
      font-size: 12px;
      color: #666;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .task-actions {
      display: flex;
      gap: 8px;
      flex-shrink: 0;
    }

    /* å†å²åˆ—è¡¨ */
    .history-list {
      list-style: none;
      max-height: 400px;
      overflow-y: auto;
    }

    .history-item {
      padding: 12px;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      transition: background 0.2s;
    }

    .history-item:hover {
      background: #fafafa;
    }

    .history-item:last-child {
      border-bottom: none;
    }

    .history-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .history-status {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }

    .history-status.success {
      background: #f6ffed;
      color: #52c41a;
      border: 1px solid #b7eb8f;
    }

    .history-status.failure {
      background: #fff1f0;
      color: #ff4d4f;
      border: 1px solid #ffa39e;
    }

    .history-time {
      color: #999;
      font-size: 12px;
    }

    .history-command {
      color: #666;
      font-size: 12px;
      font-family: 'Consolas', 'Monaco', monospace;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: white;
      border-radius: 8px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid #f0f0f0;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 600;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }

    .modal-body {
      padding: 20px;
    }

    .modal-footer {
      padding: 16px 20px;
      border-top: 1px solid #f0f0f0;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    /* è¯¦æƒ…è¾“å‡º */
    .output-section {
      margin-top: 12px;
    }

    .output-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }

    .output-content {
      background: #f5f5f5;
      border: 1px solid #f0f0f0;
      border-radius: 4px;
      padding: 12px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 12px;
      white-space: pre-wrap;
      word-break: break-all;
      max-height: 200px;
      overflow-y: auto;
    }

    .output-content.empty {
      color: #999;
    }

    /* ç©ºçŠ¶æ€ */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #999;
    }

    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }

    /* å¼€å…³ */
    .switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 22px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 22px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #1890ff;
    }

    input:checked + .slider:before {
      transform: translateX(22px);
    }

    /* æ ‡ç­¾ */
    .tag {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin-right: 4px;
    }

    .tag-interval {
      background: #e6f7ff;
      color: #1890ff;
      border: 1px solid #91d5ff;
    }

    .tag-daily {
      background: #f6ffed;
      color: #52c41a;
      border: 1px solid #b7eb8f;
    }

    .tag-cron {
      background: #fff7e6;
      color: #fa8c16;
      border: 1px solid #ffd591;
    }

    /* éšè—/æ˜¾ç¤º */
    .hidden {
      display: none;
    }

    /* Toast é€šçŸ¥ */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      font-size: 14px;
      z-index: 10000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
    }

    .toast-show {
      opacity: 1;
      transform: translateX(0);
    }

    .toast-success {
      background: #f6ffed;
      border: 1px solid #b7eb8f;
      color: #52c41a;
    }

    .toast-error {
      background: #fff1f0;
      border: 1px solid #ffa39e;
      color: #ff4d4f;
    }

    .toast-info {
      background: #e6f7ff;
      border: 1px solid #91d5ff;
      color: #1890ff;
    }

    .toast-icon {
      font-weight: bold;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- æ ‡é¢˜æ  -->
    <div class="header">
      <h1>â° å®šæ—¶ä»»åŠ¡ç®¡ç†</h1>
      <div class="header-actions">
        <button class="btn btn-primary" onclick="showAddTaskModal()">æ–°å¢ä»»åŠ¡</button>
      </div>
    </div>

    <!-- ä»»åŠ¡åˆ—è¡¨ -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">ä»»åŠ¡åˆ—è¡¨</div>
        <div>
          <span id="taskCount" style="color: #999; font-size: 12px;">0 ä¸ªä»»åŠ¡</span>
        </div>
      </div>
      <div style="margin: 12px; padding: 10px; background: #fffbe6; border: 1px solid #ffe58f; border-radius: 4px; font-size: 12px;">
        <strong>âš ï¸ åå°è¿è¡Œè®¾ç½®ï¼š</strong>
        <div style="margin-top: 6px; color: #666; line-height: 1.5;">
          è¯·å°†æ’ä»¶è®¾ç½®ä¸º <strong style="color: #d46b08;">ã€Œè·Ÿéšä¸»ç¨‹åºåŒæ—¶è¿è¡Œã€</strong>ï¼Œå…³é—­çª—å£åå®šæ—¶ä»»åŠ¡ä»ä¼šåœ¨åå°æ‰§è¡Œã€‚<br>
          â€¢ è®¾ç½®æ–¹æ³•ï¼šå³é”®æ’ä»¶ â†’ é€‰æ‹©ã€Œè·Ÿéšä¸»ç¨‹åºåŒæ—¶è¿è¡Œã€<br>
          â€¢ è®¾ç½®åï¼šå…³é—­çª—å£ä¹Ÿèƒ½æ­£å¸¸æ‰§è¡Œå®šæ—¶ä»»åŠ¡
        </div>
      </div>
      <ul id="taskList" class="task-list">
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ“‹</div>
          <p>æš‚æ— ä»»åŠ¡ï¼Œç‚¹å‡»ä¸Šæ–¹"æ–°å¢ä»»åŠ¡"æŒ‰é’®æ·»åŠ </p>
        </div>
      </ul>
    </div>

    <!-- æ‰§è¡Œå†å² -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">æ‰§è¡Œå†å²</div>
        <button class="btn btn-default btn-sm" onclick="clearHistory()">æ¸…ç©ºå†å²</button>
      </div>
      <ul id="historyList" class="history-list">
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ“œ</div>
          <p>æš‚æ— æ‰§è¡Œå†å²</p>
        </div>
      </ul>
    </div>
  </div>

  <!-- æ–°å¢/ç¼–è¾‘ä»»åŠ¡ Modal -->
  <div id="taskModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="taskModalTitle">æ–°å¢ä»»åŠ¡</div>
        <button class="modal-close" onclick="closeTaskModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="taskForm">
          <input type="hidden" id="taskId">

          <div class="form-group">
            <label class="form-label">ä»»åŠ¡åç§°ï¼ˆå¯é€‰ï¼‰</label>
            <input type="text" id="taskName" class="form-input" placeholder="ä¾¿äºè¯†åˆ«çš„åç§°">
          </div>

          <div class="form-group">
            <label class="form-label">å®šæ—¶ç±»å‹ *</label>
            <select id="taskType" class="form-select" onchange="onTypeChange()">
              <option value="interval">å›ºå®šé—´éš”</option>
              <option value="daily">æ¯å¤©å›ºå®šæ—¶é—´</option>
              <option value="cron">è‡ªå®šä¹‰ Cron</option>
            </select>
          </div>

          <div id="intervalOptions" class="form-group">
            <label class="form-label">æ‰§è¡Œé—´éš”</label>
            <select id="intervalValue" class="form-select">
              <option value="1m">1 åˆ†é’Ÿ</option>
              <option value="15m">15 åˆ†é’Ÿ</option>
              <option value="30m">30 åˆ†é’Ÿ</option>
              <option value="1h">1 å°æ—¶</option>
            </select>
          </div>

          <div id="dailyOptions" class="form-group hidden">
            <label class="form-label">æ‰§è¡Œæ—¶é—´</label>
            <input type="time" id="dailyTime" class="form-input" value="09:00">
          </div>

          <div id="cronOptions" class="form-group hidden">
            <label class="form-label">Cron è¡¨è¾¾å¼</label>
            <input type="text" id="cronExpression" class="form-input" placeholder="28 21 * * *">
            <div style="margin-top: 6px; padding: 10px; background: #f5f5f5; border-radius: 4px; font-size: 12px;">
              <div style="margin-bottom: 6px;"><strong>æ ¼å¼è¯´æ˜:</strong> åˆ† æ—¶ æ—¥ æœˆ å‘¨</div>
              <div style="margin-bottom: 6px; color: #666;">
                åˆ†é’Ÿ: 0-59 | å°æ—¶: 0-23 | æ—¥æœŸ: 1-31 | æœˆä»½: 1-12 | æ˜ŸæœŸ: 0-7 (0å’Œ7éƒ½è¡¨ç¤ºå‘¨æ—¥)
              </div>
              <div style="margin-bottom: 6px;"><strong>å¸¸ç”¨ç¤ºä¾‹:</strong></div>
              <div style="color: #666; line-height: 1.6;">
                <div>â€¢ <code>28 21 * * *</code> - æ¯å¤© 21:28 æ‰§è¡Œ</div>
                <div>â€¢ <code>0 9 * * 1-5</code> - å‘¨ä¸€åˆ°å‘¨äº”æ¯å¤© 9:00 æ‰§è¡Œ</div>
                <div>â€¢ <code>0 */2 * * *</code> - æ¯ 2 å°æ—¶æ‰§è¡Œä¸€æ¬¡</div>
                <div>â€¢ <code>0 0 * * 0</code> - æ¯å‘¨æ—¥ 00:00 æ‰§è¡Œ</div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">æ‰§è¡Œå‘½ä»¤ *</label>
            <textarea id="taskCommand" class="form-textarea" placeholder="è¾“å…¥è¦æ‰§è¡Œçš„å‘½ä»¤...&#10;Windows: dir C:\&#10;Linux/Mac: ls -la"></textarea>
          </div>

          <div class="form-group">
            <label class="form-label">
              <label class="switch">
                <input type="checkbox" id="taskEnabled" checked>
                <span class="slider"></span>
              </label>
              å¯ç”¨æ­¤ä»»åŠ¡
            </label>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" onclick="closeTaskModal()">å–æ¶ˆ</button>
        <button class="btn btn-primary" onclick="saveTask()">ä¿å­˜</button>
      </div>
    </div>
  </div>

  <!-- å†å²è¯¦æƒ… Modal -->
  <div id="historyModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">æ‰§è¡Œè¯¦æƒ…</div>
        <button class="modal-close" onclick="closeHistoryModal()">&times;</button>
      </div>
      <div class="modal-body" id="historyModalBody">
        <!-- åŠ¨æ€å¡«å…… -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" onclick="closeHistoryModal()">å…³é—­</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
